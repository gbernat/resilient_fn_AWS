<!--
    DO NOT MANUALLY EDIT THIS FILE
    THIS FILE IS AUTOMATICALLY GENERATED WITH resilient-circuits codegen
-->

# Example: AWS Describe instance

## Function - AWS: EC2 describe Instance

### API Name
`aws_ec2_describe_instance`

### Output Name
``

### Message Destination
`fn_aws`

### Pre-Processing Script
```python
inputs.aws_resource_id = artifact.value
inputs.aws_region = 'sa-east-1'
```

### Post-Processing Script
```python
# Processing if the function is a success
if(results.success):
  reservations = results.reservations
  
  for rsv in reservations:
    instances = rsv['Instances']
  
    for inst in instances:
      # Add Row
      row = incident.addRow("aws_instances")
      row["instanceid"] = inst["InstanceId"]
      row["imageid"] = inst["ImageId"]
      row["instancetype"] = inst["InstanceType"]
      row["keyname"] = inst["KeyName"]
      row["launchtime"] = inst["LaunchTime"]
      row["availabilityzone"] = inst["Placement"]["AvailabilityZone"]
      row["privatednsname"] = inst["PrivateDnsName"]
      row["publicdnsname"] = inst["PublicDnsName"]
      row["instance_state"] = inst["State"]["Name"]
      row["vpcid"] = inst["VpcId"]
      row["securitygroups"] = ('\n'.join(list(map(lambda x : x['GroupName']+' ('+x['GroupId']+')', inst["SecurityGroups"]))) if "SecurityGroups" in inst.keys() else '')
      row["tags"] = ('\n'.join(list(map(lambda x : x['Key']+': '+x['Value'], inst["Tags"]))) if "Tags" in inst.keys() else '')
```

---

